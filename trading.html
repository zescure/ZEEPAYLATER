<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>LNX Realistic Simulator (Rp)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: #0a0a0a;
      color: #0cffb3;
      font-family: monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 { color: #fff; }
    #container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    #chartPanel, #controlPanel {
      background: #101010;
      padding: 20px;
      border-radius: 8px;
    }
    #chartPanel { width: 600px; }
    #controlPanel { width: 320px; }
    .stat { margin: 8px 0; }
    input { width: 120px; padding: 5px; margin-right: 5px; }
    button {
      padding: 8px 16px;
      margin: 5px 0;
      background: #0cffb3;
      border: none;
      cursor: pointer;
      font-weight: bold;
      border-radius: 4px;
    }
    button:hover { background: #0aaa82; }
    #fakeOrder {
      margin-top: 12px;
      font-size: 14px;
      color: #ffcc00;
    }
  </style>
</head>
<body>
  <h1>ðŸª™ LNX Realistic Simulator (Rp)</h1>
  <div id="container">
    <!-- Grafik Harga -->
    <div id="chartPanel">
      <canvas id="priceChart"></canvas>
    </div>
    <!-- Panel Kontrol -->
    <div id="controlPanel">
      <div class="stat" id="priceDisplay">Harga LNX: </div>
      <div class="stat" id="poolInfo">Pool: </div>
      <div class="stat" id="userInfo">Lu: </div>
      <div id="fakeOrder" class="stat">Fake Order: </div>
      <hr>
      <div class="stat">
        <input type="number" id="buyInput" placeholder="LNX mau beli">
        <button onclick="buyLNX()">BUY</button>
      </div>
      <div class="stat">
        <input type="number" id="sellInput" placeholder="LNX mau jual">
        <button onclick="sellLNX()">SELL</button>
      </div>
    </div>
  </div>

  <script>
    // --- Parameter Awal ---
    const totalSupply = 10_000_000;
    let userLNX   = totalSupply * 0.5;      // 50% supply
    let userRp    = 1_000_000_000;          // Saldo awal 1 miliar Rp
    let poolLNX   = totalSupply - userLNX;  // Pool = 5.000.000 LNX
    let initialPrice = 100;                 // Rp per LNX
    let poolRp    = poolLNX * initialPrice; // Pool Rp = 500.000.000
    let price     = initialPrice;

    // Daftar nama fake traders
    const fakeNames = [
      'Alice','Bob','Charlie','Doni','Siti',
      'Andi','Rina','Budi','Wati','Chandra'
    ];

    // Setup Chart.js
    const ctx = document.getElementById('priceChart').getContext('2d');
    const chartData = {
      labels: Array(30).fill(''),
      datasets: [{
        label: 'Harga LNX (Rp)',
        data: Array(30).fill(price),
        borderColor: '#0cffb3',
        tension: 0.3,
        pointRadius: 0
      }]
    };
    const priceChart = new Chart(ctx, {
      type: 'line',
      data: chartData,
      options: {
        animation: false,
        scales: {
          x: { display: false },
          y: { ticks: { color: '#0cffb3' } }
        }
      }
    });

    // Format Rupiah
    function fmtRp(x) {
      return 'Rp' + x.toLocaleString('id-ID', {minimumFractionDigits: 2});
    }

    // Render ke UI
    function render() {
      price = poolRp / poolLNX;
      document.getElementById('priceDisplay').innerText =
        `Harga LNX: ${fmtRp(price)}`;
      document.getElementById('poolInfo').innerText =
        `Pool â†’ ${fmtRp(poolRp)} / ${poolLNX.toLocaleString()} LNX`;
      document.getElementById('userInfo').innerText =
        `Lu â†’ ${fmtRp(userRp)} / ${userLNX.toLocaleString()} LNX`;
      // update chart
      priceChart.data.datasets[0].data.push(price);
      priceChart.data.datasets[0].data.shift();
      priceChart.update();
    }

    // Simulasi fake market noise + fake order info
    function marketNoise() {
      const noise = (Math.random() - 0.5) * 0.002; // Â±0.2%
      const delta = poolRp * noise;
      let action, name, amtLNX, amtRp;
      
      name = fakeNames[Math.floor(Math.random()*fakeNames.length)];
      if (delta > 0 && poolLNX > 0) {
        // fake buy: poolRp naik, poolLNX turun
        amtRp = delta;
        amtLNX = delta / price;
        poolRp += amtRp;
        poolLNX -= amtLNX;
        action = 'BUY';
      } else {
        // fake sell
        amtRp = -delta;
        amtLNX = amtRp / price;
        poolRp -= amtRp;
        poolLNX += amtLNX;
        action = 'SELL';
      }
      // Tampilkan informasi fake order
      document.getElementById('fakeOrder').innerText =
        `Fake Order: ${name} ${action} ${amtLNX.toFixed(2)} LNX`;
    }

    // Aksi user BUY
    function buyLNX() {
      const amt = parseFloat(document.getElementById('buyInput').value);
      if (!amt || amt <= 0) return alert('Masukkan jumlah beli valid!');
      const cost = amt * price;
      if (userRp < cost || poolLNX < amt) {
        return alert('Saldo / pool tidak mencukupi!');
      }
      userRp -= cost; poolRp += cost;
      userLNX += amt; poolLNX -= amt;
      render();
    }

    // Aksi user SELL
    function sellLNX() {
      const amt = parseFloat(document.getElementById('sellInput').value);
      if (!amt || amt <= 0) return alert('Masukkan jumlah jual valid!');
      if (userLNX < amt) return alert('Token lu tidak cukup!');
      const gain = amt * price;
      userRp += gain; poolRp -= gain;
      userLNX -= amt; poolLNX += amt;
      render();
    }

    // Loop update setiap 1 detik
    setInterval(() => {
      marketNoise();
      render();
    }, 1000);

    // Inisialisasi
    render();
  </script>
</body>
</html>
